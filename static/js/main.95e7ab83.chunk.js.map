{"version":3,"sources":["Models/Reponse.ts","App.tsx","index.tsx"],"names":["RedBowlResponse","date","firstname","lastname","email","this","CenteredCol","styled","Col","App","useState","doc","setDoc","responses","setResponses","winnerIndex","setWinnerIndex","useEffect","GoogleSpreadsheet","useApiKey","loadInfo","then","response","sheet","sheetsByIndex","getRows","rows","cleaned","todayMoment","moment","Date","dayOfWeek","day","minHour","timeFilteredResponses","filter","r","responseMoment","responseHour","hour","isSame","dedupedResponses","find","push","cleanResponses","map","_rawData","catch","error","console","log","responseList","winner","winnerName","winnerEmail","className","span","length","onClick","randomIndex","random","int","style","width","height","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.95e7ab83.chunk.js","sourcesContent":["export class RedBowlResponse {\r\n\r\n    constructor(date: Date, firstname: string, lastname: string, email: string) {\r\n        this.date = date;\r\n        this.firstname = firstname;\r\n        this.lastname = lastname;\r\n        this.email = email;\r\n    }\r\n\r\n    date: Date;\r\n    firstname: string;\r\n    lastname: string;\r\n    email: string;\r\n};","import React, { useEffect, useState } from 'react';\nimport { GoogleSpreadsheet } from 'google-spreadsheet';\nimport { RedBowlResponse } from './Models/Reponse';\nimport { Col, Row } from 'antd';\nimport styled from 'styled-components';\nimport random from 'random';\nimport moment from 'moment';\n\nconst debug = false;\n\nconst cleanResponses = (responses: RedBowlResponse[]): RedBowlResponse[] => {\n\n\t//Filter responses to those submitted after 1 hour before curtain\n\tconst todayMoment = moment(new Date());\n\tconst dayOfWeek = todayMoment.day();\n\tlet minHour: number = 23;\n\n\tif (debug) {\n\t\tminHour = 0;\n\t} else if (dayOfWeek === 5 || dayOfWeek === 6) {\n\t\tminHour = 18;\n\t} else if (dayOfWeek === 0) {\n\t\tminHour = 13;\n\t}\n\n\tconst timeFilteredResponses = responses.filter((r) => {\n\t\tconst responseMoment = moment(r.date);\n\t\tconst responseHour = responseMoment.hour();\n\n\t\tconst isSameDay = responseMoment.isSame(todayMoment, 'day');\n\t\tconst isAfterMinHour = responseHour >= minHour\n\n\t\treturn isSameDay && isAfterMinHour;\n\t});\n\n\tconst dedupedResponses: RedBowlResponse[] = [];\n\n\tfor (const response of timeFilteredResponses) {\n\t\tconst existingResponse = dedupedResponses.find((r) => {\n\t\t\treturn r.email === response.email;\n\t\t});\n\n\t\tif (!existingResponse) {\n\t\t\tdedupedResponses.push(response);\n\t\t}\n\t}\n\n\treturn dedupedResponses;\n};\n\nconst CenteredCol = styled(Col)`\n\ttext-align: center;\n`;\n\nfunction App() {\n\n\tconst [doc, setDoc] = useState<GoogleSpreadsheet>();\n\tconst [responses, setResponses] = useState<RedBowlResponse[]>([]);\n\tconst [winnerIndex, setWinnerIndex] = useState<number>(-1);\n\n\tuseEffect(() => {\n\t\tsetDoc(new GoogleSpreadsheet('1OEry52CfvOobIL9hjQGPOCl0ncIMF_KHrtY4glougLE'));\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (doc) {\n\t\t\tdoc.useApiKey(\"AIzaSyCOrD6IBVG0UHiFANoaHMStiZXN8bYsqV8\");\n\n\t\t\tdoc.loadInfo()\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst sheet = doc?.sheetsByIndex[0];\n\t\t\t\t\tsheet?.getRows()\n\t\t\t\t\t\t.then((rows) => {\n\t\t\t\t\t\t\tconst parsedResponses = rows.map((r) => {\n\t\t\t\t\t\t\t\tconst date = r._rawData[0];\n\t\t\t\t\t\t\t\tconst firstname = r._rawData[1];\n\t\t\t\t\t\t\t\tconst lastname = r._rawData[2];\n\t\t\t\t\t\t\t\tconst email = r._rawData[3];\n\t\t\t\t\t\t\t\tconst returnResponse = new RedBowlResponse(date, firstname, lastname, email);\n\n\t\t\t\t\t\t\t\treturn returnResponse;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tconst cleaned = cleanResponses(parsedResponses);\n\t\t\t\t\t\t\tsetResponses(cleaned);\n\t\t\t\t\t\t}).catch((error) => {\n\t\t\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t\t});\n\t\t\t\t}).catch((error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t});\n\t\t}\n\t}, [doc]);\n\n\tconst generateRandomNumber = () => {\n\t\tconst randomIndex = random.int(0, responses?.length - 1);\n\t\tconsole.log(randomIndex);\n\t\tsetWinnerIndex(randomIndex);\n\t}\n\n\tconst responseList = responses?.map((response) => {\n\t\treturn <li key={response.email}>\n\t\t\t{response.email};\n\t\t</li>\n\t});\n\n\tconst winner = winnerIndex !== -1 ? responses[winnerIndex] : null;\n\tconst winnerName = `${winner?.firstname} ${winner?.lastname}`;\n\tconst winnerEmail = `${winner?.email}`;\n\n\treturn (\n\t\t<div className=\"App\">\n\t\t\t<Row>\n\t\t\t\t<CenteredCol span={24}>\n\t\t\t\t\t{\n\t\t\t\t\t\tresponses?.length > 0\n\t\t\t\t\t\t\t? <button\n\t\t\t\t\t\t\t\tonClick={generateRandomNumber}\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\twidth: \"50%\",\n\t\t\t\t\t\t\t\t\theight: \"5em\"\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tRandomly select winner\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t: <h1>No entries yet!</h1>\n\t\t\t\t\t}\n\t\t\t\t</CenteredCol>\n\t\t\t</Row>\n\t\t\t{\n\t\t\t\twinner &&\n\t\t\t\t<>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<CenteredCol span={24}>\n\t\t\t\t\t\t\t<h1>Winner:</h1>\n\t\t\t\t\t\t</CenteredCol>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<CenteredCol span={24}>\n\t\t\t\t\t\t\t<h1>{`${winnerName}, ${winnerEmail}`}</h1>\n\t\t\t\t\t\t</CenteredCol>\n\t\t\t\t\t</Row>\n\t\t\t\t</>\n\t\t\t}\n\t\t\t<Row>\n\t\t\t\t<Col span={24}>\n\t\t\t\t\t<ol>\n\t\t\t\t\t\t{responseList}\n\t\t\t\t\t</ol>\n\t\t\t\t</Col>\n\t\t\t</Row>\n\t\t</div>\n\t);\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n);"],"sourceRoot":""}